<app-header [walletBalance]="walletBalance"></app-header>

<!-- <main>
    <div class="full-wrap" id="contentToConvert" #contentToConvert>
        <div class="report-page">
            <div class="user-list inner-content">

                <div class="total_all">
                   
                    <div>
                        <a class="btn_replay" (click)='getUserBalance()'>
                            <img src="assets/aura777/transparent.gif">
                        </a>
                        <a class="add_member mb-10" href="javascript:;" (click)='openModalAddClient(addClient)'>
                            <img src="assets/aura777/transparent.gif"> Add User
                        </a>
                    </div>
                </div>

                <div class="total_box">
                    <dl class="total_dl">
                        <dt>Total Balance</dt>
                        <dd>IRP <span [ngClass]="{'red':(walletBalance?.totalBalance <= 0),'green':(walletBalance?.totalBalance > 0) }">{{walletBalance?.totalBalance | number : '0.0-2'}}</span> </dd>
                    </dl>
                    <dl class="total_dl">
                        <dt>Total Exposure</dt>
                        <dd>IRP <span [ngClass]="{'red':(walletBalance?.exposure <= 0),'green':(walletBalance?.exposure > 0) }">{{ 0 - (walletBalance?.exposure) | number : '0.0-2'}}</span></dd>
                    </dl>
                    <dl class="total_dl">
                        <dt>Available Balance</dt>
                        <dd>IRP <span [ngClass]="{'red':((walletBalance?.totalBalance + walletBalance?.exposure) <= 0),'green':((walletBalance?.totalBalance + walletBalance?.exposure) > 0) }">{{walletBalance?.totalBalance + walletBalance?.exposure | number : '0.0-2'}}</span></dd>
                    </dl>
                    <dl class="total_dl">
                        <dt>Balance</dt>
                        <dd [ngClass]="{'red':(walletBalance?.availableBalance <= 0),'green':(walletBalance?.availableBalance > 0) }">IRP {{walletBalance?.availableBalance | number : '0.0-2'}}</dd>
                    </dl>
                    <dl class="total_dl">
                        <dt>Total Avail. bal.</dt>
                        <dd>IRP <span [ngClass]="{'red':((walletBalance?.totalBalance + walletBalance?.exposure + walletBalance?.availableBalance) <= 0),'green':((walletBalance?.totalBalance + walletBalance?.exposure + walletBalance?.availableBalance) > 0) }">{{walletBalance?.totalBalance + walletBalance?.exposure + walletBalance?.availableBalance | number : '0.0-2'}}</span></dd>
                    </dl>
                    <dl class="total_dl" >
                        <dt>Upline P/L</dt>
                        
                        <dd>IRP <span [ngClass]="{'red':((walletBalance?.totalBalance + walletBalance?.exposure + walletBalance?.availableBalance - walletBalance?.creditReference) <= 0),'green':((walletBalance?.totalBalance + walletBalance?.exposure + walletBalance?.availableBalance - walletBalance?.creditReference) > 0) }">({{walletBalance?.totalBalance + walletBalance?.exposure + walletBalance?.availableBalance - walletBalance?.creditReference | number : '0.0-2'}})</span></dd>
                    </dl>
                </div>

                <div class="card my-exchange-head">
                    <div class="card-body">
                        
                        <div class="table-filter">
                            <div class="col-inner">
                                <label>Items per page:</label>
    
                                <select name="betType" class="form-select" [(ngModel)]="itemsPerPage"
                                    [ngModelOptions]="{standalone: true}" aria-label="Default select example"
                                    (change)="setSelectedOption($event.target.value)">
                                    <option value="10" selected>10</option>
                                    <option value="25">25</option>
                                    <option value="50">50</option>
                                    <option value="100">100</option>
                                </select>
                            </div>

                            <div class="col-inner">
                                <label>Search:</label>
                                <input type="text" class="form-control" [(ngModel)]="searchQuery"
                                            (ngModelChange)="searchFilter()" [ngModelOptions]="{standalone: true}"
                                            placeholder="Search UserName">
                            </div>
                        </div>
                        <div class="table-responsive">
                            <table class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th>UserName
                                            <i class="fa fa-sort-amount-asc" aria-hidden="true" [class.hide]="assendingUsername"
                                                (click)="filterList('user_name','asc')"></i>
                                            <i class="fa fa-sort-amount-desc" aria-hidden="true"
                                                [class.hide]="!assendingUsername" (click)="filterList('user_name','desc')"></i>
                                        </th>
                                        <th>Credit Ref.
                                            <i class="fa fa-sort-amount-asc" aria-hidden="true" [class.hide]="assendingUsername"
                                                (click)="filterList('user_name','asc')"></i>
                                            <i class="fa fa-sort-amount-desc" aria-hidden="true"
                                                [class.hide]="assendingUsername" (click)="filterList('user_name','desc')"></i>
                                                <i class="fa fa-sort-amount-desc" aria-hidden="true"
                                                [class.hide]="!assendingUsername" (click)="filterList('user_name','desc')"></i>
                                        </th>
                                        <th>Balance</th>
                                        
                                        <th>Exposure
                                            <i class="fa fa-sort-amount-asc" aria-hidden="true"
                                                [class.hide]="assendingUsername"></i>
                                            <i class="fa fa-sort-amount-desc" aria-hidden="true"
                                                [class.hide]="!assendingUsername"></i>
                                        </th>
                                        <th>Exposure Limit
                                            <i class="fa fa-sort-amount-asc" aria-hidden="true"
                                                [class.hide]="assendingUsername"></i>
                                            <i class="fa fa-sort-amount-desc" aria-hidden="true"
                                                [class.hide]="!assendingUsername"></i>
                                        </th>
                                        <th>Avail. Bal.
                                            <i class="fa fa-sort-amount-asc" aria-hidden="true" [class.hide]="assendingbalance"
                                                (click)="filterList('balance','asc')"></i>
                                            <i class="fa fa-sort-amount-desc" aria-hidden="true"
                                                [class.hide]="!assendingbalance" (click)="filterList('balance','desc')"></i>
                                        </th>
                                        <th>Ref. P | L</th>
                                        <th>Partnership</th>
                                        <th>Status
                                            <i class="fa fa-sort-amount-asc" aria-hidden="true" [class.hide]="assendingpoint"
                                                (click)="filterList('point','asc')"></i>
                                            <i class="fa fa-sort-amount-desc" aria-hidden="true" [class.hide]="!assendingpoint"
                                                (click)="filterList('point','desc')"></i>
                                        </th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let user of userList | paginate: { itemsPerPage: itemsPerPage, currentPage: currentPage, totalItems: total_items } ; let i=index">
                                        <td><span class="badge badge-success">user</span> {{user?.user_name}}</td>
                                        <td>
                                            <a (click)="openModalCreditRefModal(creditRefModal,user);"><strong [ngClass]="{'red':(user?.credit_reference <= 0),'green':(user?.credit_reference > 0) }">{{user?.credit_reference}}
                                                 <i class="fa fa-pencil-square-o"></i></strong></a>
                                            <a><i class="fa  fa-eye" (click)="openModalCR(creditReference,user);historyCRefrence();"></i></a>
                                        </td>
                                        
                                        <td [ngClass]="{'red':(user?.balance_reference <= 0),'green':(user?.balance_reference > 0) }">{{user?.balance_reference}}</td>
                                        <td [ngClass]="{'red':(user?.liability <= 0),'green':(user?.liability > 0) }"><strong>({{0-(user?.liability) | number : '0.0-2'}})</strong></td>
                                        <td class="exp-limit">
                                            <a (click)="openModalExposureLimit(exposureLimit,user);" ><span [ngClass]="{'red':(user?.exposure_limit <= 0),'green':(user?.exposure_limit > 0) }">{{user?.exposure_limit}}</span> 
                                            </a>
                                        </td>
                                        <td [ngClass]="{'red':(user?.balance <= 0),'green':(user?.balance > 0) }">{{user?.balance | number : '0.0-2'}}</td>
                                        <td [ngClass]="{'red':((user?.balance_reference - user?.credit_reference)<= 0),'green':((user?.balance_reference - user?.credit_reference)> 0) }">({{user?.balance_reference - user?.credit_reference | number : '0.0-2'}})</td>
                                        <td>100</td>
                                        <td>
                                            <span class="badge status-active" *ngIf="user?.parent_lock_user == 0 && user?.self_lock_user == 0">Active</span>
                                            <span class="badge status-suspended" *ngIf="user?.parent_lock_user == 1 || user?.self_lock_user == 1">Suspended</span>
                                        </td>
                                        <td>
                                            <ul class="action">
                                                <li><a class="bank" (click)="openModalDeposit(deposite);getUserAndParentDetails(user.user_id)">Bank</a></li>
                                                <li><a class="p_l" (click)="proloss(user.user_id,user.user_type_id)">Profit & Loss</a></li>
                                                <li><a class="betting_history" (click)="openBet(user.user_id,user.user_type_id)">Betting History</a></li>
                                                <li><a class="status" (click)="openModalChangeStatus(changeStatus,user);">Change Status</a></li>
                                                <li><a class="profile" (click)="account(user);">Profile</a></li>
                                                <li><a class="deleteicon" (click)="openModalDeleteList(deleteList,user);"><i class="fa  fa-trash fa-lg "></i></a></li>
                                            </ul>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="report-bottom-paginate">
                            <pagination-controls (pageChange)="pageChange($event)" class="user-list-pagination">
                            </pagination-controls>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<ng-template #addClient>
    <div class="modal-header">
        <h5 class="modal-title headtext">Add User </h5>
        <a type="button" class="close" data-dismiss="modal" (click)="modalRef.hide()"><span>×</span></a>
    </div>
    <form [formGroup]='addUserFrom'>
        <div class="modal-body">
            <div class="col-md-10">
                <div class="form-group row">
                    <label class="col-md-4">Username
                        <span class="asterisk_input"></span>
                    </label>
                    <div class="col-md-7">
                        <input type="text" placeholder="" class="form-control"
                        ngbTooltip="{{addUserFrom.controls.user_name.errors |DisplayErrorMessage}}"
                        (change)="checkUserName($event.target.value)"
                        formControlName="user_name" #userNameTooltip="ngbTooltip"
                        triggers="manual" [autoClose]="false"
                        (key)="userNameTooltip.open()" (blur)="userNameTooltip.open()">
                    </div>
                </div>
            </div>
            <div class="col-md-10">
                <div class="form-group row">
                    <label class="col-md-4">Name</label>
                    <div class="col-md-7">
                        <input type="text" placeholder="" class="form-control red-tooltip"
                        ngbTooltip="{{addUserFrom.controls.name.errors  |DisplayErrorMessage}}"
                        #clientName="ngbTooltip" triggers="manual" [autoClose]="false" (key)="clientName.open()"
                        (blur)="clientName.open()"
                        (keyup)="setUserTypeName($event.target.value)"
                        formControlName="name">
                    </div>
                </div>
            </div>
            <div class="col-md-10">
                <div class="form-group row">
                    <label class="col-md-4">Commission(%) 
                        <span class="asterisk_input"></span>
                    </label>
                    <div class="col-md-7">
                        <input type="text" value="0" placeholder="" class="form-control"
                        formControlName="match_commission" #marketTooltip="ngbTooltip"
                        triggers="manual" [autoClose]="false"
                         (key)="marketTooltip.open()"
                        (blur)="marketTooltip.open()"
                        ngbTooltip="{{addUserFrom.controls.match_commission.errors |DisplayErrorMessage}}" />
                    </div>
                </div>
            </div>
            <div class="col-md-10">
                <div class="form-group row">
                    <label class="col-md-4">Credit Reference
                        <span class="asterisk_input"></span>
                    </label>
                    <div class="col-md-7">
                        <input class="form-control" name="parentname" placeholder="Credit Reference.." type="number"  formControlName='credit_reference'>
                    </div>
                </div>
            </div>
            <div class="col-md-10">
                <div class="form-group row">
                    <label class="col-md-4">Mobile Number
                        <span class="asterisk_input"></span>
                    </label>
                    <div class="col-md-7">
                        <input class="form-control" name="parentname" placeholder="Mobile Number.." type="number"
                        formControlName="mobile">
                    </div>
                </div>
            </div>
            <div class="col-md-10">
                <div class="form-group row">
                    <label class="col-md-4">Exposure Limit
                        <span class="asterisk_input"></span>
                    </label>
                    <div class="col-md-7">
                        <input type="text" value="-1" placeholder="" [autoClose]="false"
                        class="form-control"
                        ngbTooltip="{{addUserFrom.controls.exposure_limit.errors |DisplayErrorMessage}}"
                        formControlName="exposure_limit" #exposureTooltip="ngbTooltip"
                        triggers="manual" 
                        (key)="exposureTooltip.open()" (blur)="exposureTooltip.open()"  readonly>
                    </div>
                </div>
            </div>
            
            <div class="col-md-10">
                <div class="form-group row">
                    <label class="col-md-4">Password
                        <span class="asterisk_input"></span>
                    </label>
                    <div class="col-md-7">
                        <input [type]="showPassword ? 'text' : 'password'"
                        id="password-field" pwd-control formControlName="password"
                        placeholder="" class="form-control"
                        ngbTooltip="{{addUserFrom.controls.password.errors |DisplayErrorMessage}}"
                        #passwordTooltip="ngbTooltip" triggers="manual"
                        [autoClose]="false" 
                        (key)="passwordTooltip.open()"
                        (blur)="passwordTooltip.open()"/>
                    </div>
                </div>
            </div>
            
        </div>

        <div class="modal-footer">
            <div class="text-end">
                <button type="submit" class="btn btn-primary" (click)="addUserData()">Create</button>
            </div>
        </div>
    </form>
</ng-template>

<ng-template #changeStatus>
    <div class="modal-header">
        <h4 class="modal-title">Change Status</h4>
        <a type="button" class="close" data-dismiss="modal" (click)="modalRef.hide()"><i
                class="fa fa-times"></i></a>
    </div>
    <div class="modal-body">
        <div class="body-inner">
            <div class="row">
                <div class="col-md-12">
                    <div class="form-group row">
                        <label class="col-md-12">
                            <p class="pull-left">
                                <span class="badge badge-success">USER</span>
                                
                            </p>
                            <p class="pull-right">
                                <span class="badge status-active" *ngIf="selectedUser?.parent_lock_user == 0 && selectedUser?.self_lock_user == 0">active</span>
                                <span class="badge status-suspended" *ngIf="selectedUser?.parent_lock_user == 1 || selectedUser?.self_lock_user == 1">suspended</span>
                            </p>
                        </label>
                    </div>
                </div>
            </div>
            <div class="row align-items-center stat-btn-list">
                <div class="col-6 col-sm-4 col-md-2 col-xl mb-3 mb-xl-0">
                    <button class="btn btn-block btn-outline-success" type="button" (click)="lockAccountOfUserAndTheirChilds(selectedUser.user_id, selectedUser.self_lock_user)">
                        <div class="stat-icon"><i class="fa fa-check-circle-o fa-2x"></i></div>
                        <div class="stat-text" >Active</div>
                    </button>
                </div>
                <div class="col-6 col-sm-4 col-md-2 col-xl mb-3 mb-xl-0">
                    <button class="btn btn-block btn-outline-danger" type="button"
                     (click)="lockAccountOfUserAndTheirChilds(selectedUser.user_id, selectedUser.self_lock_user)">
                        <div class="stat-icon"><i class="fa fa-ban fa-2x"></i></div>
                        <div class="stat-text">Suspend</div>
                    </button>
                </div>
                <div class="col-6 col-sm-4 col-md-2 col-xl mb-3 mb-xl-0">
                    <button class="btn btn-block btn-outline-secondary" type="button" (click)='checkedBetAllow($event,selectedUser.user_id,selectedUser.parent_id);checkedFancyBetAllow($event,selectedUser.user_id,selectedUser.parent_id,selectedUser.self_lock_fancy_bet)'>
                        <div class="stat-icon"><i class="fa fa-lock fa-2x"></i></div>
                        <div class="stat-text" *ngIf="selectedUser.self_lock_betting == 1">Locked</div>
                        <div class="stat-text" *ngIf="selectedUser.self_lock_betting == 0">UnLocked</div>
                    </button>
                </div>
            </div>
        </div>
    </div>

    
</ng-template>

<ng-template #deleteList>
    <div class="modal-header">
        <h4 class="modal-title">Confirmation</h4>
        <a type="button" class="close" data-dismiss="modal" (click)="modalRef.hide()"><i
                class="fa fa-times"></i></a>
    </div>
    <div class="modal-body">
        <div class="body-inner">
            <h5 style="font-size:1.09375rem;">Are you sure want to delete?</h5>
        </div>
    </div>

    <div class="modal-footer">
        <button type="button" class="btn btn-success" (click)="closeAccountOfUserAndTheirChilds(selectedUser.user_id, selectedUser.self_close_account,selectedUser.balance,selectedUser.liability,selectedUser.profit_loss)">Yes</button>
        
        <button type="button" class="btn btn-danger" (click)="modalRef.hide()">Cancel</button>
    </div>
</ng-template>

<ng-template #deposite>
    <form [formGroup]='depositWithdrawlForm'>
        <ng-container *ngFor="let uPData of userParentData;let i = index;">
            <div class="modal-header">
                <h4 class="modal-title">Banking - Master Balance: {{uPData?.parent_id?.balance}} </h4>
                <a type="button" class="close" data-dismiss="modal" (click)="modalRef.hide()"><i
                        class="fa fa-times"></i></a>
            </div>
            <div class="modal-body no-scroll-body">
                <div class="body-inner">
                    <div class="col-md-12">
                        <div class="form-group row">
                            <label class="col-md-3" ><strong>({{uPData.user_name}}) </strong></label>
                            <label class="col-md-8">
                                <span class="badge badge-success">USER</span>
                            </label>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="form-group row">
                            <label class="col-md-3 col-form-label">Balance</label>
                            <div class="col-md-8">
                                <input type="number" class="form-control" min="0" max="10000000000"
                                        oninput="validity.valid||(value='');" placeholder="Enter Chips"
                                        formControlName="accChips">
                                    <span *ngIf="depositWithdrawlForm.controls.accChips.errors"
                                        class="red-alert-message">
                                        {{depositWithdrawlForm.controls.accChips.errors |DisplayErrorMessage}}
                                    </span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="form-group row">
                            <label class="col-md-3 col-form-label">Remark</label>
                            <div class="col-md-8">
                                <input class="form-control" id="deposit-remark" formControlName="reMark" placeholder="Remark.." type="text">
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="form-group row">
                            <label class="col-md-3 col-form-label">Your Password</label>
                            <div class="col-md-8">
                                <input type="password" class="form-control" placeholder="password"
                                formControlName="userPass" autocomplete="new-password" required>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button (click)="depositWithdrawl(uPData?.user_id,uPData?.parent_id?.user_id,1)" type="button"
                    class="btn btn-success">Deposit</button>
                <button type="button" class="btn btn-danger" (click)="depositWithdrawl(uPData?.user_id,uPData?.parent_id?.user_id,2)">Withdraw</button>
            </div>
        </ng-container>
    </form>
</ng-template>

<ng-template #creditRefModal>
    <div class="modal-header">
        <h4 class="modal-title">Edit Credit Reference - {{selectedUser?.user_name}}        </h4>
        <a type="button" class="close" data-dismiss="modal" (click)="modalRef.hide()"><i class="fa fa-times"></i></a>
    </div>
    <div class="modal-body no-scroll-body">
        <div class="body-inner">
            <div class="col-md-12">
                <div class="form-group row">
                    <label class="col-md-3" >Current : </label>
                    <label class="col-md-8">
                        <strong>{{selectedUser?.credit_reference}}</strong>
                    </label>
                </div>
            </div>
            <div class="col-md-12">
                <div class="form-group row">
                    <label class="col-md-3" >New : </label>
                    <label class="col-md-8">
                        <input  placeholder="Credit Reference.." required="" type="number" [(ngModel)]="cRefrence">
                    </label>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <div class="text-end">
            <button type="submit" class="btn btn-success" (click)="updateCRefrence()">Submit</button> &nbsp;
            <button type="button" class="btn btn-danger" data-dismiss="modal" (click)="modalRef.hide()">Cancel</button>
        </div>
    </div>
</ng-template>

<ng-template #exposureLimit>
    <div class="modal-header">
        <h4 class="modal-title">Edit Exposure Limit - {{selectedUser?.user_name}}</h4>
        <a type="button" class="close" data-dismiss="modal" (click)="modalRef.hide()"><i class="fa fa-times"></i></a>
    </div>
    <div class="modal-body no-scroll-body">
        <div class="body-inner">
            <div class="col-md-12">
                <div class="form-group row">
                    <label class="col-md-3" >Current : </label>
                    <label class="col-md-8">
                        <strong>{{selectedUser?.exposure_limit}}</strong>
                    </label>
                </div>
            </div>
            <div class="col-md-12">
                <div class="form-group row">
                    <label class="col-md-3" >New : </label>
                    <label class="col-md-8">
                        <input  placeholder="New Exposure Limit.." required="" type="number" [(ngModel)]="updateExposureLimit">
                    </label>
                </div>
            </div>
            
        </div>
    </div>
    <div class="modal-footer">
        <div class="text-end">
            <button type="submit" class="btn btn-success" (click)="updateExpoLimit()">Submit</button> &nbsp;
            <button type="button" class="btn btn-danger" data-dismiss="modal" (click)="modalRef.hide()">Cancel</button>
        </div>
    </div>
</ng-template>

<ng-template #withdraw>
    <form [formGroup]='depositWithdrawlForm'>
        <ng-container *ngFor="let uPData of userParentData;let i = index;">
            <div class="modal-header">
                <h4 class="modal-title">Withdraw from ({{uPData.user_name}})</h4>
                <a type="button" class="close" data-dismiss="modal" (click)="modalRef.hide()"><i
                        class="fa fa-times"></i></a>
            </div>
            <div class="modal-body no-scroll-body">
                <div class="body-inner">
                    <table class="table">
                        <tbody>
                            <tr>
                                <td>Withdraw Chips :</td>
                                <td>
                                    <input type="number" class="form-control" min="0" max="10000000000"
                                        oninput="validity.valid||(value='');" placeholder="Enter Chips"
                                        formControlName="accChips">
                                    <span *ngIf="depositWithdrawlForm.controls.accChips.errors"
                                        class="red-alert-message">
                                        {{depositWithdrawlForm.controls.accChips.errors |DisplayErrorMessage}}
                                    </span>
                                </td>
                            </tr>
                            <tr>
                                <td>{{uPData?.parent_id?.user_name}}:</td>
                                <td
                                    [innerHtml]="uPData.parent_id.balance + depositWithdrawlForm.controls.accChips.value">
                                </td>
                            </tr>
                            <tr>
                                <td>{{uPData.user_name}} :</td>
                                <td [innerHtml]="uPData.balance - depositWithdrawlForm.controls.accChips.value"></td>
                            </tr>
                            <tr>
                                <td>Remarks :</td>
                                <td><textarea name="" class="form-control" id="withdraw-remark" formControlName="reMark"
                                        rows="2"></textarea></td>
                            </tr>
                            <tr>
                                <td>Password :</td>
                                <td><input type="password" class="form-control" placeholder="password"
                                        formControlName="userPass" autocomplete="new-password" required></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="modal-footer">
                <button (click)="depositWithdrawl(uPData?.user_id,uPData?.parent_id?.user_id,2)" type="button"
                    class="btn btn-success">Withdraw</button>
            </div>
        </ng-container>
    </form>
</ng-template>

<ng-template #sharing>
    <div class="modal-header">
        <h4 class="modal-title" *ngIf="loggedInUser?.user_type_id == 0">Update Sharing of ({{showSelectedUserName}})</h4>
        <h4 class="modal-title" *ngIf="loggedInUser?.user_type_id != 0"> Sharing of ({{showSelectedUserName}})</h4>
        <a type="button" class="close" data-dismiss="modal" (click)="modalRef.hide()"><i class="fa fa-times"></i></a>
    </div>
    <div class="modal-body">
        <div class="body-inner">
            <div class="partnershipList" *ngFor="let partnership of addedSportShareList ; let i=index">
                <div class="heading">{{partnership?.name}}
                    <span class="pull-right"
                        *ngIf="partnership?.percentage[partnership.percentage.length -1].user_share == tempUserShareSportList[i]?.userCurrentShare">
                        {{showSelectedUserName}} Share: {{partnership?.percentage[partnership.percentage.length
                        -1].parent_share}}</span>
                    <span class="pull-right"
                        *ngIf="partnership?.percentage[partnership.percentage.length -1].user_share != tempUserShareSportList[i]?.userCurrentShare">
                        {{showSelectedUserName}} Share: {{(partnership?.percentage[partnership.percentage.length
                        -1].parent_share)-(partnership?.percentage[partnership.percentage.length -1].parent_share -
                        partnership?.percentage[partnership.percentage.length -1].user_share)}}</span>
                    <br>
                   
                    <span class="pull-right"
                        *ngIf="partnership?.percentage[partnership.percentage.length -1].user_share != tempUserShareSportList[i]?.userCurrentShare && loggedInUser?.user_type_id == 0">
                        Parent Partnership: {{(partnership?.percentage[partnership.percentage.length
                        -2].parent_share)-(partnership?.percentage[partnership.percentage.length
                        -1].user_share)}}</span>
                </div>
                <div class="form-group" *ngIf="loggedInUser?.user_type_id == 0">
                    <label class="form-label">Partnership</label>
                    <input class="form-control" type="number" min="0" max="100" oninput="validity.valid||(value='');"
                        [(ngModel)]="partnership?.percentage[partnership.percentage.length -1].user_share"
                        (change)="checkUserEnteredShare(partnership?.percentage[partnership.percentage.length -1].user_share , partnership?.percentage[partnership.percentage.length -1].parent_share,partnership,i)">
                    <p class="red-message"
                        *ngIf="partnership?.percentage[partnership.percentage.length -1].user_share < partnership?.percentage[partnership.percentage.length -1].parent_share">
                        Please enter share greater than or equal to my partnership </p>
                </div>
            </div>
            <div class="partnershipList" *ngIf="loggedInUser?.user_type_id == 0">
                <div class="form-group">
                    <label class="form-label">Enter Password</label>
                    <input class="form-control" type="password" [(ngModel)]="updatePartnershipPassword">
                </div>
            </div>
        </div>
    </div>

    <div class="modal-footer" *ngIf="loggedInUser?.user_type_id == 0">
        <div class="text-end">
            <button type="button" (click)="updatePartnershipList()" class="btn btn-success">Submit</button>
        </div>
    </div>
</ng-template>

<ng-template #resetPwd>
    <div class="modal-header">
        <h4 class="modal-title">Change Password</h4>
        <a type="button" class="close" data-dismiss="modal" (click)="modalRef.hide()"><i class="fa fa-times"></i></a>
    </div>
    <form [formGroup]='changePasswordForm' (ngSubmit)='onSubmitChangePassword()'>
        <div class="modal-body">
            <div class="body-inner">
                <div class="form-group">
                    <label>Old Password</label>
                    <input type="password" placeholder="Old Password" class="form-control password-box"
                        formControlName='old_password'>
                    <div *ngIf="submitted && f.old_password.errors">
                        <div *ngIf="f.old_password.errors.required" class="red-message">Old password is required</div>
                    </div>
                </div>
                <div class="form-group">
                    <label>New Password</label>
                    <input type="password" placeholder="Password" class="form-control password-box"
                        formControlName='new_password'>
                    <div *ngIf="submitted && f.new_password.errors">
                        <div *ngIf="f.new_password.errors.required" class="red-message">Password is required</div>
                    </div>
                </div>
                <div class="form-group">
                    <label>Confirm Password</label>
                    <input type="password" placeholder="Password" class="form-control password-box"
                        formControlName='confirm_password'>
                    <div *ngIf="submitted && f.confirm_password.errors">
                        <div *ngIf="f.confirm_password.errors.required" class="red-message">Confirm password is required
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal-footer">
            <div class="text-end">
                <button type="submit" class="btn btn-green">Submit</button>
            </div>
        </div>
    </form>
</ng-template>

<ng-template #userPwd>
    <ng-container *ngFor="let userData of userParentData;let i = index;">
        <div class="modal-header">
            <h4 class="modal-title">Reset Password : {{userData.user_name}}</h4>
            <a type="button" class="close" data-dismiss="modal" (click)="modalRef.hide()"><i
                    class="fa fa-times"></i></a>
        </div>
        <div class="modal-body no-scroll-body">
            <div class="body-inner">
                <div class="form-group inner-addon right-addon">
                    <label class="form-label">Password</label>
                    <div class="input-group" [formGroup]="resetPasswordForm">
                        <input [type]="showPassword ? 'text' : 'password'" id="password-field" pwd-control
                            formControlName="password" placeholder="" class="form-control" />

                        <div>
                            <i alt="show" class="fa fa-eye eye-show" (click)="showPassword = !showPassword"
                                [class.hide]="showPassword"></i>
                            <i alt="hide" class="fa fa-eye-slash eye-hide" (click)="showPassword = !showPassword"
                                [class.hide]="!showPassword"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <div class="text-end">
                <button type="submit" class="btn btn-success"
                    (click)="changeChildPwd(userData?.user_id,userData?.parent_id?.user_id)">Submit</button>
            </div>
        </div>
    </ng-container>
</ng-template>

<ng-template #rawPwd>
    <div class="modal-header">
        <h4 class="modal-title">Enter Transaction In Password </h4>
        <a type="button" class="close" data-dismiss="modal" (click)="modalRef.hide()"><i class="fa fa-times"></i></a>
    </div>
    <div class="modal-body no-scroll-body">
        <div class="body-inner">
            <div class="form-list">
                <label class="form-heading">Enter Logged In Password</label>
                <input type="password" placeholder="Enter Logged In Password" class="password-box form-attribute"
                    [(ngModel)]="transactionPassword" [ngModelOptions]="{standalone: true}">
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <div class="text-end">
            <button type="submit" class="btn btn-success" (click)="getUserRawPassword()">Submit</button>
        </div>
    </div>
</ng-template>

<ng-template #permissionSetting>
    <div class="modal-header">
        <h4 class="modal-title">Update Permission Setting of username </h4>
        <a type="button" class="close" data-dismiss="modal" (click)="modalRef.hide()"><i class="fa fa-times"></i></a>
    </div>
    <div class="modal-body no-scroll-body">
        <div class="body-inner">
            <div class="form-check">
                <input class="form-check-input" type="checkbox" id="sportPermission" checked>
                <label class="form-check-label" for="sportPermission">Cricket</label>
            </div>
            <div class="form-check">
                <input class="form-check-input" type="checkbox" id="sportPermission1">
                <label class="form-check-label" for="sportPermission1">Soccer</label>
            </div>
            <div class="form-check">
                <input class="form-check-input" type="checkbox" id="sportPermission2">
                <label class="form-check-label" for="sportPermission2">Tennis</label>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <div class="text-end">
            <button type="submit" class="btn btn-success" (click)="getUserRawPassword()">Submit</button>&nbsp;
            <button type="button" class="btn btn-danger" data-dismiss="modal" (click)="modalRef.hide()">Cancel</button>
        </div>
    </div>
</ng-template>

<ng-template #comissionSetting>
    <div class="modal-header">
        <h4 class="modal-title">Update Comission Setting of username </h4>
        <a type="button" class="close" data-dismiss="modal" (click)="modalRef.hide()"><i class="fa fa-times"></i></a>
    </div>
    <div class="modal-body no-scroll-body">
        <div class="body-inner">
            <div class="form-list">
                <label class="form-heading">Market Commission</label>
                <input type="number" min="0" max="99" placeholder="Market Commission" [(ngModel)]="marketCommission"
                    value="0" class="password-box form-attribute">
            </div>
            <div class="form-list">
                <label class="form-heading">Session Commission</label>
                <input type="number" min="0" max="99" placeholder="Session Commission" [(ngModel)]="sessionCommission"
                    value="0" class="password-box form-attribute">
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <div class="text-end">
            <button type="submit" class="btn btn-success" (click)="updateUserCommission()">Submit</button> &nbsp;
            <button type="button" class="btn btn-danger" data-dismiss="modal" (click)="modalRef.hide()">Cancel</button>
        </div>
    </div>
</ng-template>

<ng-template #sportSettingOld>
    <div class="modal-header">
        <h4 class="modal-title">User Sports Settings : {{showSelectedUserName}}</h4>
        <a type="button" class="close" data-dismiss="modal" (click)="modalRef.hide()"><i class="fa fa-times"></i></a>
    </div>
    <div class="modal-body">
        <div class="body-inner">
            <div class="form-main">
                <form [formGroup]='sportsForm'>
                    <div class="accordion" id="accordionExample">
                        <div class="sports-setting-main-section" formArrayName="sports_settings">
                            <div class="market-session-setting"
                                *ngFor="let sportSettingitem of sportsSettingsFormArr.controls; let j=index">
                                <div class="accordion-item" [formGroupName]="j">
                                    <h4 class="accordion-header" id="heading-{{j}}">
                                        <a class="accordion-title" type="button" data-bs-toggle="collapse"
                                            data-bs-target="#collapse-{{j}}" aria-controls="collapse-{{j}}">
                                            {{specificUserDetails[j]?.name}} Settings
                                        </a>
                                    </h4>
                                    <div id="collapse-{{j}}" class="accordion-collapse collapse show"
                                        aria-labelledby="heading-{{j}}" data-bs-parent="#accordionExample"
                                        *ngIf="hiddenpass[j]">
                                        <div class="accordion-body">
                                            <div class="detail-row">
                                                <div class="detail-row-heading">
                                                    <h4>Market Setting</h4>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-3 col-sm-4 col-12">
                                                        <div class="col-inner">
                                                            <div class="form-group">
                                                                <label class="form-label">Min. Stake Amount</label>
                                                                <input type="number" formControlName="market_min_stack"
                                                                    placeholder="" class="form-control" />
                                                                <span>[Note: Point]</span><br>
                                                                <span
                                                                    *ngIf="sportSettingitem.controls.market_min_stack.errors"
                                                                    class="red-alert-message">
                                                                    {{sportSettingitem.controls.market_min_stack.errors
                                                                    |DisplayErrorMessage}}
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-3 col-sm-4 col-12">
                                                        <div class="col-inner">
                                                            <div class="form-group">
                                                                <label class="form-label">Max. Stake Amount</label>
                                                                <input type="number" formControlName="market_max_stack"
                                                                    placeholder="" class="form-control" />
                                                                <span>[Note: Point(if no limit then enter
                                                                    -1)]</span><br>
                                                                <span
                                                                    *ngIf="sportSettingitem.controls.market_max_stack.errors"
                                                                    class="red-alert-message">
                                                                    {{sportSettingitem.controls.market_max_stack.errors
                                                                    |DisplayErrorMessage}}
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-3 col-sm-4 col-12">
                                                        <div class="col-inner">
                                                            <div class="form-group">
                                                                <label class="form-label">Min. Odds Rate</label>
                                                                <input type="number"
                                                                    formControlName="market_min_odds_rate"
                                                                    placeholder="" class="form-control" />
                                                                <span>[Note: Point]</span><br>
                                                                <span
                                                                    *ngIf="sportSettingitem.controls.market_min_odds_rate.errors"
                                                                    class="red-alert-message">
                                                                    {{sportSettingitem.controls.market_min_odds_rate.errors
                                                                    |DisplayErrorMessage}}
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-3 col-sm-4 col-12">
                                                        <div class="col-inner">
                                                            <div class="form-group">
                                                                <label class="form-label">Max. Odds Rate</label>
                                                                <input type="number"
                                                                    formControlName="market_max_odds_rate"
                                                                    placeholder="" class="form-control" />
                                                                <span>[Note: Point(if no limit then enter
                                                                    -1)]</span><br>
                                                                <span
                                                                    *ngIf="sportSettingitem.controls.market_max_odds_rate.errors"
                                                                    class="red-alert-message">
                                                                    {{sportSettingitem.controls.market_max_odds_rate.errors
                                                                    |DisplayErrorMessage}}
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-3 col-sm-4 col-12">
                                                        <div class="col-inner">
                                                            <div class="form-group">
                                                                <label class="form-label">Match Bets Delay</label>
                                                                <input type="number" formControlName="market_bet_delay"
                                                                    placeholder="" class="form-control" />
                                                                <span>[Second]</span><br>
                                                                <span
                                                                    *ngIf="sportSettingitem.controls.market_bet_delay.errors"
                                                                    class="red-alert-message">
                                                                    {{sportSettingitem.controls.market_bet_delay.errors
                                                                    |DisplayErrorMessage}}
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-3 col-sm-4 col-12">
                                                        <div class="col-inner">
                                                            <div class="form-group">
                                                                <label class="form-label">Market Max Profit</label>
                                                                <input type="number" formControlName="market_max_profit"
                                                                    placeholder="" class="form-control" />
                                                                <span>[Note: Point(if no limit then enter
                                                                    -1)]</span><br>
                                                                <span
                                                                    *ngIf="sportSettingitem.controls.market_max_profit.errors"
                                                                    class="red-alert-message">
                                                                    {{sportSettingitem.controls.market_max_profit.errors
                                                                    |DisplayErrorMessage}}
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-3 col-sm-4 col-12">
                                                        <div class="col-inner">
                                                            <div class="form-group">
                                                                <label class="form-label">Before Inplay Match
                                                                    Stake</label>
                                                                <input type="number"
                                                                    formControlName="market_advance_bet_stake"
                                                                    placeholder="" class="form-control" />
                                                                <span>[Note: Point(if no limit then enter
                                                                    -1)]</span><br>
                                                                <span
                                                                    *ngIf="sportSettingitem.controls.market_advance_bet_stake.errors"
                                                                    class="red-alert-message">
                                                                    {{sportSettingitem.controls.market_advance_bet_stake.errors
                                                                    |DisplayErrorMessage}}
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="detail-row" *ngIf="specificUserDetails[j]?.sport_id == '4'">
                                                <div class="detail-row-heading">
                                                    <h4>Session Setting</h4>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-3 col-sm-4 col-12">
                                                        <div class="col-inner">
                                                            <div class="form-group">
                                                                <label class="form-label">Min. Stake Amount</label>
                                                                <input type="number" formControlName="session_min_stack"
                                                                    placeholder="" class="form-control" />
                                                                <span>[Note: Point]</span><br>
                                                                <span
                                                                    *ngIf="sportSettingitem.controls.session_min_stack.errors"
                                                                    class="red-alert-message">
                                                                    {{sportSettingitem.controls.session_min_stack.errors
                                                                    |DisplayErrorMessage}}
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-3 col-sm-4 col-12">
                                                        <div class="col-inner">
                                                            <div class="form-group">
                                                                <label class="form-label">Max. Stake Amount</label>
                                                                <input type="number" formControlName="session_max_stack"
                                                                    placeholder="" class="form-control" />
                                                                <span>[Note: Point(if no limit then enter
                                                                    -1)]</span><br>
                                                                <span
                                                                    *ngIf="sportSettingitem.controls.session_max_stack.errors"
                                                                    class="red-alert-message">
                                                                    {{sportSettingitem.controls.session_max_stack.errors
                                                                    |DisplayErrorMessage}}
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-3 col-sm-4 col-12">
                                                        <div class="col-inner">
                                                            <div class="form-group">
                                                                <label class="form-label">Session Bet Delay</label>
                                                                <input type="number" formControlName="session_bet_delay"
                                                                    placeholder="" class="form-control" />
                                                                <span>[Second]</span><br>
                                                                <span
                                                                    *ngIf="sportSettingitem.controls.session_bet_delay.errors"
                                                                    class="red-alert-message">
                                                                    {{sportSettingitem.controls.session_bet_delay.errors
                                                                    |DisplayErrorMessage}}
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-3 col-sm-4 col-12">
                                                        <div class="col-inner">
                                                            <div class="form-group">
                                                                <label class="form-label">Session Max Profit</label>
                                                                <input type="number"
                                                                    formControlName="session_max_profit" placeholder=""
                                                                    class="form-control" />
                                                                <span>[Note: Point(if no limit then enter
                                                                    -1)]</span><br>
                                                                <span
                                                                    *ngIf="sportSettingitem.controls.session_max_profit.errors"
                                                                    class="red-alert-message">
                                                                    {{sportSettingitem.controls.session_max_profit.errors
                                                                    |DisplayErrorMessage}}
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-success"
                                                    (click)="updateSportWiseSettingDetails(sportSettingitem[j],j)">Save</button>
                                            </div>

                                        </div>
                                    </div>


                                </div>


                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>


</ng-template>

<ng-template #sportSetting>
    <div class="modal-header">
        <label class="modal-title">User Sports Settings : {{showSelectedUserName}}</label>
        <a type="button" class="close" data-dismiss="modal" (click)="modalRef.hide()"><i class="fa fa-times"></i></a>
    </div>
    <div class="modal-body no-scroll-body sport-setting-body">
        <div class="body-inner">

            <div class="filter-tab">
                <nav>
                    <div class="nav nav-tabs" id="nav-tab" role="tablist">
                        <ng-container *ngFor="let sportName of specificUserDetails;let i = index">
                            <a class="nav-link active" data-bs-toggle="tab" data-bs-target="#nav-{{sportName?.name}}"
                                [ngClass]="{'active': i === selectedIndex}"
                                (click)="selectPill(i)">{{sportName?.name}}</a>
                        </ng-container>
                    </div>
                </nav>
                <div class="tab-content" id="nav-tabContent">
                    <div class="tab-pane fade show active" id="nav-{{sportName?.name}}">
                        <div class="form-main">
                            <form [formGroup]='sportsForm'>
                                <div class="sports-setting-main-section" formArrayName="sports_settings">
                                    <div class="market-session-setting"
                                        *ngFor="let sportSettingitem of sportsSettingsFormArr.controls; let j=index"
                                        [formGroupName]='j'>

                                        <div class="detail-row" *ngIf="selectedIndex === j">
                                            <div class="detail-row-heading">
                                                <h4>Market Setting</h4>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-3 col-sm-4 col-12">
                                                    <div class="col-inner">
                                                        <div class="form-group">
                                                            <label class="form-label">Min. Stake Amount</label>
                                                            <input type="number" formControlName="market_min_stack"
                                                                ngbTooltip="{{sportSettingitem.controls.market_min_stack.errors |DisplayErrorMessage}}"
                                                                placeholder="" class="form-control"
                                                                (keyup)="applyValidatorsForMaxStack(j)" #t1="ngbTooltip"
                                                                triggers="manual" [autoClose]="false"
                                                                (mouseenter)="t1.open()" (key)="t1.open()"
                                                                (blur)="t1.open()" />

                                                           
                                                            <span *ngIf="sportErrorData?.market_min_stack"
                                                                class="red-alert-message">
                                                                {{sportErrorData.market_min_stack[0].short_error}}
                                                                <i class="fa fa-info"
                                                                    ngbTooltip="{{sportErrorData.market_min_stack[1].long_error}}"></i>
                                                            </span>

                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-3 col-sm-4 col-12">
                                                    <div class="col-inner">
                                                        <div class="form-group">
                                                            <label class="form-label">Max. Stake Amount</label>
                                                            <input type="number" formControlName="market_max_stack"
                                                                placeholder="" class="form-control"
                                                                ngbTooltip="{{sportSettingitem.controls.market_max_stack.errors |DisplayErrorMessage}}"
                                                                #t2="ngbTooltip" triggers="manual" [autoClose]="false"
                                                                (mouseenter)="t2.open()" (key)="t2.open()"
                                                                (blur)="t2.open()" />

                                                           
                                                            <span *ngIf="sportErrorData?.market_max_stack"
                                                                class="red-alert-message">
                                                                {{sportErrorData.market_max_stack[0].short_error}}
                                                                <i class="fa fa-info"
                                                                    ngbTooltip="{{sportErrorData.market_max_stack[1].long_error}}"></i>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-3 col-sm-4 col-12">
                                                    <div class="col-inner">
                                                        <div class="form-group">
                                                            <label class="form-label">Min. Odds Rate</label>
                                                            <input type="number" formControlName="market_min_odds_rate"
                                                                ngbTooltip="{{sportSettingitem.controls.market_min_odds_rate.errors |DisplayErrorMessage}}"
                                                                placeholder="" class="form-control"
                                                                (keyup)="applyValidatorsForMaxOddsRate(j)"
                                                                #t3="ngbTooltip" triggers="manual" [autoClose]="false"
                                                                (mouseenter)="t3.open()" (key)="t3.open()"
                                                                (blur)="t3.open()" />

                                                            
                                                            <span *ngIf="sportErrorData?.market_min_odds_rate"
                                                                class="red-alert-message">
                                                                {{sportErrorData.market_min_odds_rate[0].short_error}}
                                                                <i class="fa fa-info"
                                                                    ngbTooltip="{{sportErrorData.market_min_odds_rate[1].long_error}}"></i>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-3 col-sm-4 col-12">
                                                    <div class="col-inner">
                                                        <div class="form-group">
                                                            <label class="form-label">Max. Odds Rate</label>
                                                            <input type="number" formControlName="market_max_odds_rate"
                                                                placeholder="" class="form-control"
                                                                ngbTooltip="{{sportSettingitem.controls.market_max_odds_rate.errors |DisplayErrorMessage}}"
                                                                #t4="ngbTooltip" triggers="manual" [autoClose]="false"
                                                                (mouseenter)="t4.open()" (key)="t4.open()"
                                                                (blur)="t4.open()" />

                                                            
                                                            <span *ngIf="sportErrorData?.market_max_odds_rate"
                                                                class="red-alert-message">
                                                                {{sportErrorData.market_max_odds_rate[0].short_error}}
                                                                <i class="fa fa-info"
                                                                    ngbTooltip="{{sportErrorData.market_max_odds_rate[1].long_error}}"></i>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-3 col-sm-4 col-12">
                                                    <div class="col-inner">
                                                        <div class="form-group">
                                                            <label class="form-label">Match Bets Delay</label>
                                                            <input type="number" formControlName="market_bet_delay"
                                                                placeholder="" class="form-control"
                                                                ngbTooltip="{{sportSettingitem.controls.market_bet_delay.errors |DisplayErrorMessage}}"
                                                                #t5="ngbTooltip" triggers="manual" [autoClose]="false"
                                                                (mouseenter)="t5.open()" (key)="t5.open()"
                                                                (blur)="t5.open()" />

                                                            
                                                            <span *ngIf="sportErrorData?.market_bet_delay"
                                                                class="red-alert-message">
                                                                {{sportErrorData.market_bet_delay[0].short_error}}
                                                                <i class="fa fa-info"
                                                                    ngbTooltip="{{sportErrorData.market_bet_delay[1].long_error}}"></i>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-3 col-sm-4 col-12">
                                                    <div class="col-inner">
                                                        <div class="form-group">
                                                            <label class="form-label">Market Max Profit</label>
                                                            <input type="number" formControlName="market_max_profit"
                                                                placeholder="" class="form-control"
                                                                ngbTooltip="{{sportSettingitem.controls.market_max_profit.errors |DisplayErrorMessage}}"
                                                                #t6="ngbTooltip" triggers="manual" [autoClose]="false"
                                                                (mouseenter)="t6.open()" (key)="t6.open()"
                                                                (blur)="t6.open()" />

                                                            
                                                            <span *ngIf="sportErrorData?.market_max_profit"
                                                                class="red-alert-message">
                                                                {{sportErrorData.market_max_profit[0].short_error}}
                                                                <i class="fa fa-info"
                                                                    ngbTooltip="{{sportErrorData.market_max_profit[1].long_error}}"></i>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-3 col-sm-4 col-12">
                                                    <div class="col-inner">
                                                        <div class="form-group">
                                                            <label class="form-label">Before Inplay Match Stake</label>
                                                            <input type="number" #t7="ngbTooltip" triggers="manual"
                                                                [autoClose]="false" (mouseenter)="t7.open()"
                                                                (key)="t7.open()" (blur)="t7.open()"
                                                                formControlName="market_advance_bet_stake"
                                                                placeholder="" class="form-control"
                                                                ngbTooltip="{{sportSettingitem.controls.market_advance_bet_stake.errors |DisplayErrorMessage}}" />

                                                            
                                                            <span *ngIf="sportErrorData?.market_advance_bet_stake"
                                                                class="red-alert-message">
                                                                {{sportErrorData.market_advance_bet_stake[0].short_error}}
                                                                <i class="fa fa-info"
                                                                    ngbTooltip="{{sportErrorData.market_advance_bet_stake[1].long_error}}"></i>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="detail-row"
                                            *ngIf="specificUserDetails[j]?.sport_id == '4' && selectedIndex === j">
                                            <div class="detail-row-heading">
                                                <h4>Session Setting</h4>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-3 col-sm-4 col-12">
                                                    <div class="col-inner">
                                                        <div class="form-group">
                                                            <label class="form-label">Min. Stake Amount</label>
                                                            <input type="number" formControlName="session_min_stack"
                                                                ngbTooltip="{{sportSettingitem.controls.session_min_stack.errors |DisplayErrorMessage}}"
                                                                placeholder="" class="form-control"
                                                                (keyup)="applyValidatorsForMaxstake(j)" #t8="ngbTooltip"
                                                                triggers="manual" [autoClose]="false"
                                                                (mouseenter)="t8.open()" (key)="t8.open()"
                                                                (blur)="t8.open()" />

                                                       
                                                            <span *ngIf="sportErrorData?.session_min_stack"
                                                                class="red-alert-message">
                                                                {{sportErrorData.session_min_stack[0].short_error}}
                                                                <i class="fa fa-info"
                                                                    ngbTooltip="{{sportErrorData.session_min_stack[1].long_error}}"></i>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-3 col-sm-4 col-12">
                                                    <div class="col-inner">
                                                        <div class="form-group">
                                                            <label class="form-label">Max. Stake Amount</label>
                                                            <input type="number" formControlName="session_max_stack"
                                                                placeholder="" class="form-control"
                                                                ngbTooltip="{{sportSettingitem.controls.session_max_stack.errors |DisplayErrorMessage}}"
                                                                #t9="ngbTooltip" triggers="manual" [autoClose]="false"
                                                                (mouseenter)="t9.open()" (key)="t9.open()"
                                                                (blur)="t9.open()" />

                                                            
                                                            <span *ngIf="sportErrorData?.session_max_stack"
                                                                class="red-alert-message">
                                                                {{sportErrorData.session_max_stack[0].short_error}}
                                                                <i class="fa fa-info"
                                                                    ngbTooltip="{{sportErrorData.session_max_stack[1].long_error}}"></i>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-3 col-sm-4 col-12">
                                                    <div class="col-inner">
                                                        <div class="form-group">
                                                            <label class="form-label">Session Bet Delay</label>
                                                            <input type="number" formControlName="session_bet_delay"
                                                                #t10="ngbTooltip" triggers="manual" [autoClose]="false"
                                                                (mouseenter)="t10.open()" (key)="t10.open()"
                                                                (blur)="t10.open()" placeholder="" class="form-control"
                                                                ngbTooltip="{{sportSettingitem.controls.session_bet_delay.errors |DisplayErrorMessage}}" />

                                                           
                                                            <span *ngIf="sportErrorData?.session_bet_delay"
                                                                class="red-alert-message">
                                                                {{sportErrorData.session_bet_delay[0].short_error}}
                                                                <i class="fa fa-info"
                                                                    ngbTooltip="{{sportErrorData.session_bet_delay[1].long_error}}"></i>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-3 col-sm-4 col-12">
                                                    <div class="col-inner">
                                                        <div class="form-group">
                                                            <label class="form-label">Session Max Profit</label>
                                                            <input type="number" formControlName="session_max_profit"
                                                                #t11="ngbTooltip" triggers="manual" [autoClose]="false"
                                                                (mouseenter)="t11.open()" (key)="t11.open()"
                                                                (blur)="t11.open()" placeholder="" class="form-control"
                                                                ngbTooltip="{{sportSettingitem.controls.session_max_profit.errors |DisplayErrorMessage}}" />

                                                          
                                                            <span *ngIf="sportErrorData?.session_max_profit"
                                                                class="red-alert-message">
                                                                {{sportErrorData.session_max_profit[0].short_error}}
                                                                <i class="fa fa-info"
                                                                    ngbTooltip="{{sportErrorData.session_max_profit[1].long_error}}"></i>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="modal-footer" *ngIf="selectedIndex === j">
                                            <div class="text-end">
                                                <button type="submit" class="btn btn-success"
                                                    (click)="updateSportWiseSettingDetails(sportSettingitem[j],j)">Save</button>
                                                &nbsp;
                                                <button type="button" class="btn btn-danger" data-dismiss="modal"
                                                    (click)="modalRef.hide()">Cancel</button>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</ng-template>

<ng-template #exposure>
    <div class="modal-header">
        <h4 class="modal-title">Exposure of {{expo_User_name}}</h4>
        <a type="button" class="close" data-dismiss="modal" (click)="modalRef.hide()"><i class="fa fa-times"></i></a>
    </div>
    <table class="table">
        <thead>
            <tr>
                <th>S.No.</th>
                <th>SportName</th>
                <th>Event Name</th>
                <th>Market</th>
                <th>Exposure</th>
            </tr>
        </thead>
        <tbody>
            <ng-container *ngFor="let expo of exposureData;let i=index;">
                <tr *ngIf="i < (expoLength-1)">
                    <td>{{i+1}}</td>
                    <td>{{expo?.sport_name}}</td>
                    <td>{{expo?.match_name}}</td>
                    <td>{{expo?.event_name}}</td>
                    <td [ngClass]="{'red': expo?.liability < 0 ,'green': expo?.liability >= 0}">{{expo?.liability | number : '0.0-2'}}</td>
                </tr>
                <tr *ngIf="i == (expoLength-1)">
                    <td></td>
                    <td></td>
                    <td></td>
                    <td>Total</td>
                    <td [ngClass]="{'red': expo?.liabilitySum < 0 ,'green': expo?.liabilitySum >= 0}">
                        {{expo?.liabilitySum | number : '0.0-2'}}</td>
                </tr>
            </ng-container>
        </tbody>
    </table>
</ng-template>

<ng-template #userParentList>
    <div class="modal-header">
        <h4 class="modal-title">Parent List of {{userParentName}}</h4>
        <a type="button" class="close" data-dismiss="modal" (click)="modalRef.hide()"><i class="fa fa-times"></i></a>
    </div>
    <table class="table">
        <tbody>
            <ng-container *ngFor="let parent of parentList; let i =index">
                <tr>
                    <td>{{parent?.name}}({{parent?.user_name}})</td>
                </tr>
                
                
            </ng-container>
        </tbody>
    </table>
</ng-template>

<ng-template #creditReference>
    <div class="modal-header" style="width : 635px !important">
        <h4 class="modal-title">Credit Refrence of {{selectedUser?.user_name}}</h4>
        <a type="button" class="close" data-dismiss="modal" (click)="modalRef.hide()"><i class="fa fa-times"></i></a>
    </div>
    <div class="card my-exchange-head" style="width: 635px !important;">
        <div class="card-body">
            
            <div class="table-filter">
                <div class="col-inner">
                    <label>Items per page:</label>

                    <select name="betType" class="form-select" [(ngModel)]="itemsPP"
                        [ngModelOptions]="{standalone: true}" aria-label="Default select example"
                        (change)="setSelectedPageOption($event.target.value)">
                        <option value="10" selected>10</option>
                        <option value="25">25</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                    </select>
                </div>

                <div class="col-inner">
                    <label>Search:</label>
                    <input type="text" class="form-control" [(ngModel)]="searchParam"
                                (ngModelChange)="historyCRefrence()" [ngModelOptions]="{standalone: true}"
                                placeholder="Search UserName">
                </div>
            </div>
            <div class="table-responsive">
                <table class="table table-bordered">
                    <thead>
                        <tr>
                           <th>From Name</th>
                           <th>User Name</th>
                           <th>Old Credit Reference</th>
                           <th>New Credit Reference</th>
                           <th>Date</th>
                        </tr>
                    </thead>
                    <tbody>
                       <tr *ngFor="let history of historyCrData | paginate: { itemsPerPage: itemsPP, currentPage: currentPageNo, totalItems: totalItems };let i= index;">
                        <td>{{history?.from}}</td>
                        <td>{{history?.name}}</td>
                        <td>{{history?.old_credit_reference}}</td>
                        <td>{{history?.new_credit_reference}}</td>
                        <td>{{history?.createdAt | date :'dd-MM-yyyy hh:mm:ss aa'}}</td>
                       </tr>
                    </tbody>
                </table>
            </div>
            <div class="report-bottom-paginate">
                <pagination-controls (pageChange)="popupPageChange($event)" class="user-list-pagination">
                </pagination-controls>
            </div>
        </div>
    </div>
</ng-template> -->


<div id="layoutSidenav" class="mt-3">
    <div id="layoutSidenav_nav" class="d-none">
        <nav class="sb-sidenav accordion sb-sidenav-dark" id="sidenavAccordion">
            <div class="sb-sidenav-menu">
                <div class="nav">
                    <div class="sb-sidenav-menu-heading">Core</div>
                    <a class="nav-link" href="index.html">
                        <div class="sb-nav-link-icon"><i class="fas fa-tachometer-alt"></i></div>
                        Dashboard
                    </a>
                    <div class="sb-sidenav-menu-heading">Interface</div>
                    <a class="nav-link collapsed" href="#" data-bs-toggle="collapse" data-bs-target="#collapseLayouts"
                        aria-expanded="false" aria-controls="collapseLayouts">
                        <div class="sb-nav-link-icon"><i class="fas fa-columns"></i></div>
                        Layouts
                        <div class="sb-sidenav-collapse-arrow"><i class="fas fa-angle-down"></i></div>
                    </a>
                    <div class="collapse" id="collapseLayouts" aria-labelledby="headingOne"
                        data-bs-parent="#sidenavAccordion">
                        <nav class="sb-sidenav-menu-nested nav">
                            <a class="nav-link" href="layout-static.html">Static Navigation</a>
                            <a class="nav-link" href="layout-sidenav-light.html">Light Sidenav</a>
                        </nav>
                    </div>
                    <a class="nav-link collapsed" href="#" data-bs-toggle="collapse" data-bs-target="#collapsePages"
                        aria-expanded="false" aria-controls="collapsePages">
                        <div class="sb-nav-link-icon"><i class="fas fa-book-open"></i></div>
                        Pages
                        <div class="sb-sidenav-collapse-arrow"><i class="fas fa-angle-down"></i></div>
                    </a>
                    <div class="collapse" id="collapsePages" aria-labelledby="headingTwo"
                        data-bs-parent="#sidenavAccordion">
                        <nav class="sb-sidenav-menu-nested nav accordion" id="sidenavAccordionPages">
                            <a class="nav-link collapsed" href="#" data-bs-toggle="collapse"
                                data-bs-target="#pagesCollapseAuth" aria-expanded="false"
                                aria-controls="pagesCollapseAuth">
                                Authentication
                                <div class="sb-sidenav-collapse-arrow"><i class="fas fa-angle-down"></i></div>
                            </a>
                            <div class="collapse" id="pagesCollapseAuth" aria-labelledby="headingOne"
                                data-bs-parent="#sidenavAccordionPages">
                                <nav class="sb-sidenav-menu-nested nav">
                                    <a class="nav-link" href="login.html">Login</a>
                                    <a class="nav-link" href="register.html">Register</a>
                                    <a class="nav-link" href="password.html">Forgot Password</a>
                                </nav>
                            </div>
                            <a class="nav-link collapsed" href="#" data-bs-toggle="collapse"
                                data-bs-target="#pagesCollapseError" aria-expanded="false"
                                aria-controls="pagesCollapseError">
                                Error
                                <div class="sb-sidenav-collapse-arrow"><i class="fas fa-angle-down"></i></div>
                            </a>
                            <div class="collapse" id="pagesCollapseError" aria-labelledby="headingOne"
                                data-bs-parent="#sidenavAccordionPages">
                                <nav class="sb-sidenav-menu-nested nav">
                                    <a class="nav-link" href="401.html">401 Page</a>
                                    <a class="nav-link" href="404.html">404 Page</a>
                                    <a class="nav-link" href="500.html">500 Page</a>
                                </nav>
                            </div>
                        </nav>
                    </div>
                    <div class="sb-sidenav-menu-heading">Addons</div>
                    <a class="nav-link" href="charts.html">
                        <div class="sb-nav-link-icon"><i class="fas fa-chart-area"></i></div>
                        Charts
                    </a>
                    <a class="nav-link" href="tables.html">
                        <div class="sb-nav-link-icon"><i class="fas fa-table"></i></div>
                        Tables
                    </a>
                </div>
            </div>
            <div class="sb-sidenav-footer">
                <div class="small">Logged in as:</div>
                Aura777
            </div>
        </nav>
    </div>
    <div id="layoutSidenav_content" class="p-0">
        <main>
            <div class="d-flex justify-content-end total_all">
                <a class="add_member mb-10" (click)='openModalAddClient(addClient)'>
                    <img src="./assets/img/transparent.gif">Add User</a>
                <a class="btn_replay" id="refresh" (click)='getUserBalance();getUserChildDetail(user_id, true)'>
                    <img  src="./assets/img/transparent.gif"></a>
            </div>
            <div class="container-fluid px-3">
                <div class="total-box">
                    <ul class="d-flex justify-content-end total-box-inner">
                        <li class="total-list">
                            <span class="total-list-name">Total Balance</span>
                            <span class="total-list-amount"
                                [ngClass]="{'red':(walletBalance?.totalBalance <= 0) }">IRP
                                {{walletBalance?.totalBalance | number : '0.0-2'}}</span>
                        </li>
                        <li class="total-list">
                            <span class="total-list-name">Total Exposure</span>
                            <span class="total-list-amount"
                                [ngClass]="{'red':(walletBalance?.exposure <= 0),'green':(walletBalance?.exposure > 0) }">IRP
                                ({{ 0 - (walletBalance?.exposure) | number : '0.0-2'}})</span>
                        </li>
                        <li class="total-list">
                            <span class="total-list-name">Available Balance</span>
                            <span class="total-list-amount"
                                [ngClass]="{'red':((walletBalance?.totalBalance + walletBalance?.exposure) <= 0) }">IRP
                                {{walletBalance?.totalBalance + walletBalance?.exposure | number : '0.0-2'}}</span>
                        </li>
                        <li class="total-list">
                            <span class="total-list-name">Balance</span>
                            <span class="total-list-amount"
                                [ngClass]="{'red':(walletBalance?.availableBalance <= 0) }">IRP
                                {{ walletBalance?.availableBalance | number : '0.0-2'}}</span>
                        </li>
                        <li class="total-list">
                            <span class="total-list-name">Total Avail. bal.</span>
                            <span class="total-list-amount"
                                [ngClass]="{'red':((walletBalance?.totalBalance + walletBalance?.exposure + walletBalance?.availableBalance) <= 0) }">{{walletBalance?.totalBalance
                                + walletBalance?.exposure + walletBalance?.availableBalance | number : '0.0-2'}}</span>
                        </li>
                        <li class="total-list">
                            <span class="total-list-name">Upline P/L</span>
                            <span class="total-list-amount"
                            [ngClass]="{'red':((walletBalance?.totalBalance  + walletBalance?.availableBalance - walletBalance?.creditReference) <= 0),'green':((walletBalance?.totalBalance  + walletBalance?.availableBalance - walletBalance?.creditReference) > 0) }">IRP
                            ({{walletBalance?.totalBalance  + walletBalance?.availableBalance - walletBalance?.creditReference | number : '0.0-2'}})</span>
                        </li>
                    </ul>
                </div>
                <div class="card mb-4">
                    <div class="card-body">
                        <div class="table-data-filter">
                            <div class="dataTables_length" id="">
                                <label>
                                    Show
                                    <select [(ngModel)]="itemsPP" [ngModelOptions]="{standalone: true}"
                                        aria-label="Default select example"
                                        (change)="setSelectedPageOption($event.target.value)">
                                        <option value="10" selected>10</option>
                                        <option value="25">25</option>
                                        <option value="50">50</option>
                                        <option value="100">100</option>
                                    </select>
                                    entries
                                </label>
                            </div>
                            <div class="dataTables_filter">
                                <label>Search:<input type="search" [(ngModel)]="searchQuery"
                                        (ngModelChange)="getUserChildDetail(user_id)"
                                        [ngModelOptions]="{standalone: true}" placeholder="Search UserName"></label>
                            </div>
                        </div>
                        <table id="" class="dataTable-table">
                            <thead>
                                <tr>
                                    <th>Username</th>
                                    <th>Credit Ref.</th>
                                    <th>Balance</th>
                                    <th>Exposure</th>
                                    <th>Exposure Limit</th>
                                    <th>Avail .Bal.</th>
                                    <th>Ref. P/L</th>
                                    <!-- <th>Partnership</th> -->
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr
                                    *ngFor="let user of userList |  paginate: { itemsPerPage: itemsPerPage, currentPage: currentPage, totalItems: total_items }; let i=index">
                                    <td class="table-font-weight"><span
                                            class="badge badge-success me-1 text-uppercase">{{user?.label}}</span>{{user?.user_name}}
                                    </td>

                                    <td class="text-blue">
                                        <span class="me-1"><strong
                                                [ngClass]="{'red':(user?.credit_reference <= 0),'green':(user?.credit_reference > 0) }">{{user?.credit_reference}}</strong></span>
                                        <a (click)="openModalCreditRefModal(creditRefModal,user);">
                                            <span class="table-icon"><i class="fas fa-pen-to-square fa-fw"></i></span>
                                        </a>
                                        <a (click)="openModalCR(creditReference,user);historyCRefrence();"
                                            class="text-blue">
                                            <span class="table-icon"><i class="fas fa-eye fa-fw"></i></span>
                                        </a>
                                    </td>


                                    <td class="table-font-weight"
                                        [ngClass]="{'red':(user?.available_balance <= 0),'green':(user?.available_balance > 0) }">
                                        {{user?.available_balance | number : '0.0-2'}}</td>

                                    <td class="text-red table-font-weight"
                                        [ngClass]="{'red':(user?.exposure <= 0),'green':(user?.exposure > 0) }">
                                        ({{0-(user?.exposure) | number : '0.0-2'}})</td>

                                    <td class="text-blue">
                                        <a (click)="openModalExposureLimit(exposureLimit,user);" class="text-blue">
                                            <span class="me-1"
                                                [ngClass]="{'red':(user?.exposure_limit <= 0),'green':(user?.exposure_limit > 0) }"><strong>{{user?.exposure_limit}}</strong></span>
                                            <span class="table-icon"><i class="fas fa-pen-to-square fa-fw"></i></span>
                                        </a>
                                    </td>


                                    <td class="table-font-weight"
                                        [ngClass]="{'red':(user?.balance <= 0),'green':(user?.balance > 0) }">
                                        {{user?.balance | number : '0.0-2'}}</td>

                                    <td class="table-font-weight text-red"
                                        [ngClass]="{'red':((user?.available_balance - user?.credit_reference)<= 0),'green':((user?.available_balance - user?.credit_reference)> 0) }">
                                        ({{user?.available_balance - user?.credit_reference | number : '0.0-2'}})</td>

                                    <!-- <td class="table-font-weight">{{user?.partnership}}</td> -->
                                    <td>
                                        <span class="badge status-active"
                                            *ngIf="(user?.parent_lock_user == 0 && user?.self_lock_user == 0) && (user?.self_lock_betting == 0 && user?.self_lock_fancy_bet == 0)">Active</span>
                                        <span class="badge status-lock" 
                                            *ngIf="(user?.parent_lock_user == 1 || user?.self_lock_user == 1) ">locked</span>
                                        <span class="badge status-suspend"
                                            *ngIf="(user?.self_lock_betting == 1 || user?.self_lock_fancy_bet == 1) && (user?.self_lock_user == 0)">Suspended</span>
                                    
                                    </td>

                                    <td>
                                        <ul class="table-action">
                                            <li>
                                                <a class="bank" title="Banking"
                                                    (click)="openModalDeposit(deposite);getUserAndParentDetails(user.user_id)">Bank</a>
                                            </li>
                                            <li>
                                                <a class="p_l" routerlink="/my-account/profit-loss" title="Profit/Loss"
                                                    (click)="proloss(user.user_id,user.user_type_id)">Profit &amp; Loss</a>
                                            </li>
                                            <li>
                                                <a class="betting_history" routerlink="/my-account/bet-history"
                                                    title="Bet History"
                                                    (click)="openBet(user.user_id,user.user_type_id)">Betting History</a>
                                            </li>
                                            <li>
                                                <a class="status" title="Setting"
                                                    (click)="openModalChangeStatus(masterStatus,user);">Change
                                                    Status</a>
                                            </li>
                                            <li>
                                                <a class="profile" title="Profile" (click)="account(user);">Profile</a>
                                            </li>
                                            <li>
                                                <a class="deleteicon" title="deleteicon"
                                                    (click)="openModalDeleteList(deleteList, user);">
                                                    <i class="fas fa-trash-can fa-fw"></i>
                                                </a>
                                            </li>
                                        </ul>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="table-data-footer">
                            <div class="dataTables_info" id="DataTables_Table_0_info" role="status" aria-live="polite">
                            </div>
                            <div class="dataTables_paginate paging_full_numbers">
                                <pagination-controls (pageChange)="pageChange($event)" class="user-list-pagination">
                                </pagination-controls>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <div class="modal fade" id="master_balance" tabindex="-1" role="dialog" aria-labelledby="masterbalanceModalLabel"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-content">
                    <div class="modal-header bg-primary">
                        <h5 class="modal-title text-white" id="masterbalanceModalLabel"> Banking - <strong>Master
                                Balance: 97305</strong></h5>
                        <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="col-md-12">
                            <div class="form-group row">
                                <label class="col-md-2">
                                    <strong>hdemo</strong>
                                </label>
                                <label class="col-md-8">
                                    <span class="badge badge-success"> USER</span>
                                </label>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group row">
                                <label class="col-md-2 col-form-label">Balance</label>
                                <div class="col-md-8">
                                    <input class="form-control ng-untouched ng-pristine ng-valid" name="balancedw"
                                        placeholder="0" type="text">
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group row">
                                <label class="col-md-2 col-form-label">Remark</label>
                                <div class="col-md-8">
                                    <input class="form-control ng-untouched ng-pristine ng-valid" id="balanceRemark"
                                        name="balanceRemark" placeholder="Remark.." type="text">
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group row">
                                <label class="col-md-2 col-form-label">Your Password</label>
                                <div class="col-md-8">
                                    <input autocomplete="new-password"
                                        class="form-control ng-untouched ng-pristine ng-valid" name="masterPass"
                                        placeholder="Password.." type="password">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" data-dismiss="modal" class="btn btn-success">Deposite</button>
                        <button type="button" class="btn btn-danger">Withdraw</button>
                    </div>
                </div>
            </div>
        </div>
    </div>


</div>

<ng-template #addClient class="modal">
    <div class="modal-header">
        <h5 class="modal-title modal-client-title" id="useraddModalLabel"> Add User </h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="modalRef.hide()">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <form class="ng-untouched ng-pristine ng-invalid" [formGroup]='addUserFrom'>
        <div class="modal-body client-modal">
            <div class="col-md-10">
                <div class="form-group row">
                    <label class="col-md-6">Username <sup class="text-red">*</sup></label>
                    <div class="col-md-6">
                        <input class="form-control ng-untouched ng-pristine ng-invalid" name="username"
                            placeholder="Username.." type="text" formControlName="user_name">
                        <div class="text-danger" *ngIf="isControlIsValid('user_name')">
                            <span *ngIf="isControlHasErros('user_name')">
                                {{ isControlHasErros('user_name') | DisplayErrorMessage}}
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-10">
                <div class="form-group row">
                    <label class="col-md-6">Name
                        <sup class="text-red">*</sup>
                    </label>
                    <div class="col-md-6">
                        <input class="form-control ng-untouched ng-pristine ng-valid" name="name" placeholder="Name.."
                            formControlName="name" type="text">
                        <div class="text-danger" *ngIf="isControlIsValid('name')">
                            <span *ngIf="isControlHasErros('name')">
                                {{ isControlHasErros('name') | DisplayErrorMessage}}
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-10">
                <div class="form-group row">
                    <label class="col-md-6">Commission(%)
                        <sup class="text-red">*</sup>
                    </label>
                    <div class="col-md-6">
                        <input class="form-control ng-untouched ng-pristine ng-invalid" name="commission" formControlName="match_commission"
                            placeholder="Commission.." type="text" (keypress)="keyPressNumbers($event)">
                        <div class="text-danger" *ngIf="isControlIsValid('match_commission')">
                            <span *ngIf="isControlHasErros('match_commission')">
                                {{ isControlHasErros('match_commission') | DisplayErrorMessage}}
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            <!-- <div class="col-md-10">
              <div class="form-group row">
                 <label class="col-md-6">Opening Balance 
                 <sup class="text-red">*</sup>
                 </label>
                 <div class="col-md-6">
                    <input class="form-control ng-untouched ng-pristine ng-invalid" name="balance" placeholder="Opening Balance.." required="" type="text">
                 </div>
              </div>
           </div> -->
            <div class="col-md-10">
                <div class="form-group row">
                    <label class="col-md-6">Credit Reference
                        <sup class="text-red">*</sup>
                    </label>
                    <div class="col-md-6">
                        <input class="form-control ng-untouched ng-pristine ng-invalid"
                            formControlName='credit_reference' name="creditRef" placeholder="Credit Reference.."
                            type="text">
                        <div class="text-danger" *ngIf="isControlIsValid('credit_reference')">
                            <span *ngIf="isControlHasErros('credit_reference')">
                                {{ isControlHasErros('credit_reference') | DisplayErrorMessage}}
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-10">
                <div class="form-group row">
                    <label class="col-md-6">Mobile Number
                        <sup class="text-red">*</sup>
                    </label>
                    <div class="col-md-6">
                        <input class="form-control ng-untouched ng-pristine ng-invalid" formControlName="mobile"
                            name="mobile" placeholder="Mobile Number.." type="text">
                        <div class="text-danger" *ngIf="isControlIsValid('mobile')">
                            <span *ngIf="isControlHasErros('mobile')">
                                {{ isControlHasErros('mobile') | DisplayErrorMessage}}
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-10">
                <div class="form-group row">
                    <label class="col-md-6">Exposure Limit
                        <sup class="text-red">*</sup>
                    </label>
                    <div class="col-md-6">
                        <input class="form-control ng-untouched ng-pristine ng-invalid" name="exposure"
                            formControlName="exposure_limit" placeholder="Exposure Limit.." type="text">
                        <div class="text-danger" *ngIf="isControlIsValid('exposure_limit')">
                            <span *ngIf="isControlHasErros('exposure_limit')">
                                {{ isControlHasErros('exposure_limit') | DisplayErrorMessage}}
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-10">
                <div class="form-group row">
                    <label class="col-md-6">Password <sup class="text-red">*</sup></label>
                    <div class="col-md-6">
                        <input autocomplete="new-password" class="form-control ng-untouched ng-pristine ng-invalid"
                            formControlName="password" name="password" placeholder="Password.." type="password">
                        <div class="text-danger" *ngIf="isControlIsValid('password')">
                            <span *ngIf="isControlHasErros('password')">
                                {{ isControlHasErros('password') | DisplayErrorMessage}}
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            <!-- <div class="col-md-10">
              <div class="form-group row">
                 <label class="col-md-6">Confirm Password 
                 <sup class="text-red">*</sup>
                 </label>
                 <div class="col-md-6">
                    <input autocomplete="new-password" class="form-control ng-untouched ng-pristine ng-invalid" name="confirm_pass" placeholder="Confirm Password.." required="" type="password">
                 </div>
              </div>
           </div> -->
            <!-- <div class="col-md-10">
                <div class="form-group row">
                    <label class="col-md-6">Rolling Commission</label>
                    <div class="col-md-6">
                        <label class="switch switch-label switch-primary pull-left">
                            <input checked="" class="switch-input ng-untouched ng-pristine ng-valid" name="isCommission"
                                type="checkbox">
                            <span class="switch-slider" data-checked="✓" data-unchecked="✕">
                            </span>
                        </label>
                    </div>
                </div>
            </div> -->
            <!-- <div class="col-md-10">
              <hr>
              <div class="form-group row">
                 <label class="col-md-6">Master Password <span class="asterisk_input"></span>
                 </label>
                 <div class="col-md-6">
                    <input autocomplete="new-password" class="form-control ng-untouched ng-pristine ng-invalid" name="masterPass" placeholder="Master Password.." required="" type="password">
                 </div>
              </div>
           </div> -->
        </div>
        <div class="modal-footer modal-footer-client">
            <button class="btn btn-primary" type="submit" (click)="addUserData()">Create</button>
        </div>
    </form>
</ng-template>

<ng-template #deleteList class="modal">
    <div class="modal-header bg-primary">
        <h5 class="modal-title text-white">Confirmation</h5>
        <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close"
            (click)="modalRef.hide()">
            <span aria-hidden="true">×</span>
        </button>
    </div>
    <div class="modal-body text-center">
        <h5>Are you sure want to delete?</h5>
    </div>
    <div class="modal-footer">
        <button class="btn btn-primary" type="button"
            (click)="closeAccountOfUserAndTheirChilds(selectedUser.user_id, '0',selectedUser.balance,selectedUser.exposure,(selectedUser?.available_balance - selectedUser?.credit_reference))">Yes</button>
        <button class="btn btn-default" type="button" (click)="modalRef.hide()">Cancel</button>
    </div> 
</ng-template>

<ng-template #deposite class="modal">
    <form [formGroup]='depositWithdrawlForm'>
        <ng-container *ngFor="let uPData of userParentData;let i = index;">
            <div class="modal-header bg-primary">
                <h5 class="modal-title text-white" id="masterbalanceModalLabel"> Banking - <strong>Master Balance:
                        {{uPData?.parent_id?.balance}}</strong></h5>
                <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close"
                    (click)="modalRef.hide()">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="col-md-12">
                    <div class="form-group row">
                        <label class="col-md-2">
                            <strong>{{uPData.user_name}}</strong>
                        </label>
                        <label class="col-md-8">
                            <span class="badge badge-success"> USER</span>
                        </label>
                    </div>
                </div>
                <div class="col-md-12">
                    <div class="form-group row">
                        <label class="col-md-2 col-form-label">Balance</label>
                        <div class="col-md-8">
                            <input class="form-control ng-untouched ng-pristine ng-valid" name="balancedw"
                                placeholder="0" type="number" min="0" max="10000000000"
                                oninput="validity.valid||(value='');" formControlName="accChips">
                            <span *ngIf="depositWithdrawlForm.controls.accChips.errors" class="red-alert-message">
                                {{depositWithdrawlForm.controls.accChips.errors |DisplayErrorMessage}}
                            </span>
                        </div>
                    </div>
                </div>
                <div class="col-md-12">
                    <div class="form-group row">
                        <label class="col-md-2 col-form-label">Remark</label>
                        <div class="col-md-8">
                            <input class="form-control ng-untouched ng-pristine ng-valid" formControlName="reMark"
                                id="balanceRemark" name="balanceRemark" placeholder="Remark.." type="text">
                        </div>
                    </div>
                </div>
                <div class="col-md-12">
                    <div class="form-group row">
                        <label class="col-md-2 col-form-label">Your Password</label>
                        <div class="col-md-8">
                            <input autocomplete="new-password" class="form-control ng-untouched ng-pristine ng-valid"
                                name="masterPass" placeholder="Password.." type="password" formControlName="userPass">
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" data-dismiss="modal" class="btn btn-success"
                    (click)="depositWithdrawl(uPData?._id,uPData?.parent_id?._id,1)">Deposite</button>
                <button type="button" class="btn btn-danger"
                    (click)="depositWithdrawl(uPData?._id,uPData?.parent_id?._id,2)">Withdraw</button>
            </div>
        </ng-container>
    </form>
</ng-template>

<ng-template #masterStatus class="modal">
    <div class="modal-header bg-primary">
        <h5 class="modal-title text-white" id="mastersstatusModalLabel"> Change Status </h5>
        <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close"
            (click)="modalRef.hide()">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="row">
            <div class="col-md-12">
                <p class="pull-left">
                    <span class="badge badge-success me-1">USER</span>{{selectedUser?.user_name}}
                </p>
                <p class="pull-right">
                    <span class="badge status-active"
                        *ngIf="selectedUser?.parent_lock_user == 0 && selectedUser?.self_lock_user == 0">active</span>
                    <span class="badge status-suspended"
                        *ngIf="selectedUser?.parent_lock_user == 1 || selectedUser?.self_lock_user == 1">Locked</span>
                </p>
            </div>
        </div>
        <div class="divider"></div>
        <div class="row align-items-center stat-btn-list">
            <div class="col-6 col-sm-4 col-md-2 col-xl mb-3 mb-xl-0">
                <button class="btn btn-block btn-outline-success" [ngClass]="{'active':(selectedStatus == 1) }"  type="button"
                    [disabled]="selectedUser?.parent_lock_user == 0 && selectedUser?.self_lock_user == 0"
                    (click)="onChangeStatus(1)">
                    <div class="stat-icon">
                        <i class="fas fa-circle-check fa-fw"></i>
                    </div>
                    <div class="stat-text">Active</div>
                </button>
            </div>
            <div class="col-6 col-sm-4 col-md-2 col-xl mb-3 mb-xl-0">
                <button class="btn btn-block btn-outline-danger" [ngClass]="{'active':(selectedStatus == 3) }" 
                    type="button"
                    (click)="onChangeStatus(3)">
                    <div class="stat-icon">
                        <i class="fas fa-ban fa-fw"></i>
                    </div>
                    <div class="stat-text">Suspend</div>
                </button>
            </div>
            <div class="col-6 col-sm-4 col-md-2 col-xl mb-3 mb-xl-0">
                <button class="btn btn-block btn-outline-secondary" [ngClass]="{'active':(selectedStatus == 2) }"
                [disabled]="selectedUser?.parent_lock_user == 1 || selectedUser?.self_lock_user == 1" 
                 type="button" (click)='onChangeStatus(2)'>
                    <div class="stat-icon">
                        <i class="fas fa-lock fa-fw"></i>
                    </div>
                    <div class="stat-text" *ngIf="selectedUser.self_lock_user == 1">Locked</div>
                    <div class="stat-text" *ngIf="selectedUser.self_lock_user == 0">UnLocked</div>
                </button>
            </div>
        </div>
    </div>
    <div class="divider"></div>
    <div class="modal-footer">
        <div class="row">
            <div class="col-md-6">
                <input autocomplete="new-password" class="form-control ng-untouched ng-pristine ng-invalid" name="rate"
                    placeholder="Password.." required="" type="password">
            </div>
            <div class="col-md-6">
                <button class="btn btn-primary change-status" type="button" (click)="onChangeCall()">Change</button>
            </div>
        </div>
    </div>
</ng-template>

<ng-template #exposureLimit class="modal">
    <div class="modal-header bg-primary">
        <h5 class="modal-title text-white" id="exposurelimitModalLabel"> Edit Exposure Limit -
            <span>{{selectedUser?.user_name}}</span> </h5>
        <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close"
            (click)="modalRef.hide()">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="col-md-12">
            <div class="form-group row">
                <label class="col-md-2">Current</label>
                <label class="col-md-8"><strong>{{selectedUser?.exposure_limit}}</strong></label>
            </div>
        </div>
        <div class="col-md-12">
            <div class="form-group row">
                <label class="col-md-2 col-form-label">New</label>
                <div class="col-md-8">
                    <input class="form-control ng-untouched ng-pristine ng-invalid" name="creditReference"
                        placeholder="New Exposure Limit.." required="" type="number" [(ngModel)]="updateExposureLimit">
                </div>
            </div>
        </div>
        <div class="col-md-12">
            <div class="form-group row">
                <label class="col-md-2 col-form-label">Password</label>
                <div class="col-md-8">
                    <input autocomplete="new-password" class="form-control ng-untouched ng-pristine ng-invalid"
                        name="rate" placeholder="Password.." required="" type="password">
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button class="btn btn-primary" type="button" (click)="updateExpoLimit()">Submit</button>
        <button class="btn btn-default" type="button" (click)="modalRef.hide()">Cancel</button>
    </div>
</ng-template>

<ng-template #creditRefModal class="modal">
    <div class="modal-header bg-primary">
        <h5 class="modal-title text-white" id="creditreferenceModalLabel"> Edit Credit Reference -
            <span>{{selectedUser?.user_name}}</span></h5>
        <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close"
            (click)="modalRef.hide()">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="col-md-12">
            <div class="form-group row">
                <label class="col-md-2">Current</label>
                <label class="col-md-8"><strong>{{selectedUser?.credit_reference}}</strong></label>
            </div>
        </div>
        <div class="col-md-12">
            <div class="form-group row">
                <label class="col-md-2 col-form-label">New</label>
                <div class="col-md-8">
                    <input class="form-control ng-untouched ng-pristine ng-invalid" name="creditReference"
                        placeholder="New Credit Reference.." required="" type="number" [(ngModel)]="cRefrence">
                </div>
            </div>
        </div>
        <div class="col-md-12">
            <div class="form-group row">
                <label class="col-md-2 col-form-label">Password</label>
                <div class="col-md-8">
                    <input autocomplete="new-password" class="form-control ng-untouched ng-pristine ng-invalid"
                        name="rate" placeholder="Password.." required="" type="password">
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button class="btn btn-primary" type="button" (click)="updateCRefrence()">Submit</button>
        <button class="btn btn-default" type="button" (click)="modalRef.hide()">Cancel</button>
    </div>
</ng-template>

<ng-template #creditReference class="modal">
    <div class="modal-header bg-primary">
        <h5 class="modal-title text-white" id="creditreferencelogModalLabel"> Edit Credit Reference Log -
            <span>{{selectedUser?.user_name}}</span></h5>
        <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close"
            (click)="modalRef.hide()">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="card-body">
            <table id="datatablesSimple" class="dataTable-table">
                <thead>
                    <tr>
                        <th>From Name</th>
                        <th>Username</th>
                        <th>Old Credit Reference</th>
                        <th>New Credit Reference</th>
                    </tr>
                </thead>
                <tbody>
                    <tr
                        *ngFor="let history of historyCrData | paginate: { itemsPerPage: itemsPP, currentPage: currentPageNo, totalItems: totalItems };let i= index;">
                        <td class="text-red table-font-weight">({{history?.from}})</td>
                        <td class="table-font-weight">{{history?.name}}</td>
                        <td class="table-font-weight text-red">({{history?.old_credit_reference}})</td>
                        <td class="table-font-weight">{{history?.new_credit_reference}}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div class="modal-footer">
        <button class="btn btn-primary" type="button">Submit</button>
        <button class="btn btn-default" type="button" (click)="modalRef.hide()">Cancel</button>
    </div>
</ng-template>